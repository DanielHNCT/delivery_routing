# ğŸš€ PROMPT COMPLETO PARA DESARROLLO ANDROID APP - DELIVERY ROUTING

## ğŸ“‹ **CONTEXTO DEL PROYECTO**

**Proyecto:** Sistema de Enrutamiento de Repartidores Colis PrivÃ©  
**Estado:** Backend API funcionando + Sistema de migraciÃ³n activo  
**Objetivo:** App Android funcional para demo del martes  
**Arquitectura:** API Rust + Redis + PostgreSQL  

---

## ğŸ¯ **REQUISITOS FUNCIONALES DE LA APP**

### **1. AUTENTICACIÃ“N**
- Login con credenciales Colis PrivÃ©
- Manejo de tokens de sesiÃ³n
- Logout y limpieza de datos

### **2. DASHBOARD PRINCIPAL**
- Vista general del dÃ­a
- Estado de conexiÃ³n con API
- Indicadores de performance
- Botones de navegaciÃ³n principales

### **3. GESTIÃ“N DE TOURNÃ‰E**
- Lista de tours del dÃ­a
- Detalles de cada tour
- Estado de entregas (pendiente, en curso, completada)
- Mapa de ruta optimizada

### **4. DETALLES DE ENTREGA**
- InformaciÃ³n del paquete
- DirecciÃ³n de entrega
- CÃ³digo de barras/QR
- Foto de confirmaciÃ³n
- Firma digital

### **5. SINCRONIZACIÃ“N**
- SincronizaciÃ³n offline/online
- Cache local de datos
- SincronizaciÃ³n automÃ¡tica en background
- Manejo de errores de conexiÃ³n

---

## ğŸ—ï¸ **ARQUITECTURA TÃ‰CNICA**

### **PATRÃ“N DE ARQUITECTURA**
```
MVVM + Repository Pattern + Clean Architecture
```

### **COMPONENTES PRINCIPALES**
- **Activities/Fragments:** UI y navegaciÃ³n
- **ViewModels:** LÃ³gica de presentaciÃ³n
- **Repository:** Acceso a datos (API + Local)
- **API Service:** ComunicaciÃ³n con backend
- **Database:** Room para cache local
- **DI:** Hilt para inyecciÃ³n de dependencias

### **TECNOLOGÃAS RECOMENDADAS**
- **Kotlin:** 100% Kotlin
- **Jetpack Compose:** UI moderna
- **Coroutines:** Async/await
- **Retrofit:** API calls
- **Room:** Base de datos local
- **Hilt:** Dependency injection
- **Navigation Component:** NavegaciÃ³n
- **ViewModel + LiveData:** Estado de UI

---

## ğŸ”— **ENDPOINTS DE API DISPONIBLES**

### **BASE URL:** `http://192.168.1.101:3000` (Pi 5 Master)

### **1. AUTENTICACIÃ“N**
```
POST /api/colis-prive/auth
Content-Type: application/json

{
  "username": "tu_usuario",
  "password": "tu_password"
}

Response:
{
  "success": true,
  "token": "jwt_token_aqui",
  "expires_at": "2025-08-19T10:00:00Z"
}
```

### **2. TOURNÃ‰E MÃ“VIL**
```
POST /api/colis-prive/mobile-tournee
Authorization: Bearer {token}
Content-Type: application/json

{
  "date": "2025-08-18",
  "driver_id": "DRIVER_001"
}

Response:
{
  "success": true,
  "tournee": {
    "id": "TOUR_001",
    "date": "2025-08-18",
    "driver_id": "DRIVER_001",
    "deliveries": [
      {
        "id": "DEL_001",
        "package_id": "PKG_001",
        "address": "123 Calle Principal",
        "city": "Madrid",
        "postal_code": "28001",
        "status": "pending",
        "estimated_time": "14:30",
        "coordinates": {
          "lat": 40.4168,
          "lng": -3.7038
        }
      }
    ],
    "total_deliveries": 25,
    "estimated_duration": "8h 30m",
    "total_distance": "45.2 km"
  }
}
```

### **3. ACTUALIZAR ESTADO DE ENTREGA**
```
PUT /api/colis-prive/delivery/{delivery_id}/status
Authorization: Bearer {token}
Content-Type: application/json

{
  "status": "completed",
  "completed_at": "2025-08-18T14:30:00Z",
  "photo_url": "base64_encoded_photo",
  "signature": "base64_encoded_signature",
  "notes": "Entregado en recepciÃ³n"
}

Response:
{
  "success": true,
  "delivery": {
    "id": "DEL_001",
    "status": "completed",
    "completed_at": "2025-08-18T14:30:00Z"
  }
}
```

### **4. HEALTH CHECK**
```
GET /api/colis-prive/health

Response:
{
  "status": "healthy",
  "timestamp": "2025-08-18T10:00:00Z",
  "version": "1.0.0"
}
```

---

## ğŸ“± **ESTRUCTURA DE LA APP**

### **PACKAGES RECOMENDADOS**
```
com.deliveryrouting.android/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ ColisPriveApiService.kt
â”‚   â”‚   â”œâ”€â”€ AuthInterceptor.kt
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”œâ”€â”€ local/
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ preferences/
â”‚   â”‚   â””â”€â”€ models/
â”‚   â””â”€â”€ repository/
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ usecases/
â”‚   â””â”€â”€ repository/
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ tournee/
â”‚   â”‚   â””â”€â”€ delivery/
â”‚   â”œâ”€â”€ viewmodels/
â”‚   â””â”€â”€ common/
â”œâ”€â”€ di/
â””â”€â”€ utils/
```

### **ACTIVITIES/FRAGMENTS PRINCIPALES**
1. **SplashActivity:** Pantalla de carga inicial
2. **LoginActivity:** AutenticaciÃ³n
3. **MainActivity:** Contenedor principal con Navigation
4. **DashboardFragment:** Vista general
5. **TourneeListFragment:** Lista de tours
6. **TourneeDetailFragment:** Detalles del tour
7. **DeliveryDetailFragment:** Detalles de entrega
8. **SettingsFragment:** ConfiguraciÃ³n

---

## ğŸ¨ **UI/UX REQUIREMENTS**

### **DESIGN SYSTEM**
- **Material Design 3:** Componentes modernos
- **Colores:** Tema claro/oscuro
- **TipografÃ­a:** Roboto o similar
- **Iconos:** Material Icons

### **PANTALLAS CLAVE**
1. **Login:** Usuario/contraseÃ±a + botÃ³n login
2. **Dashboard:** Cards con mÃ©tricas + navegaciÃ³n
3. **Tour List:** RecyclerView con tours del dÃ­a
4. **Tour Detail:** Mapa + lista de entregas
5. **Delivery Detail:** Formulario de confirmaciÃ³n

### **COMPONENTES REUTILIZABLES**
- **DeliveryCard:** Card para mostrar entrega
- **StatusChip:** Chip para estado de entrega
- **LoadingButton:** BotÃ³n con estado de carga
- **ErrorView:** Vista de error reutilizable
- **EmptyStateView:** Estado vacÃ­o

---

## ğŸ”§ **CONFIGURACIÃ“N TÃ‰CNICA**

### **GRADLE DEPENDENCIES**
```gradle
dependencies {
    // Core Android
    implementation 'androidx.core:core-ktx:1.12.0'
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'com.google.android.material:material:1.11.0'
    
    // Jetpack Compose
    implementation platform('androidx.compose:compose-bom:2024.02.00')
    implementation 'androidx.compose.ui:ui'
    implementation 'androidx.compose.material3:material3'
    implementation 'androidx.compose.ui:ui-tooling-preview'
    
    // Architecture Components
    implementation 'androidx.lifecycle:lifecycle-viewmodel-ktx:2.7.0'
    implementation 'androidx.lifecycle:lifecycle-livedata-ktx:2.7.0'
    implementation 'androidx.navigation:navigation-compose:2.7.6'
    
    // Dependency Injection
    implementation 'com.google.dagger:hilt-android:2.48'
    kapt 'com.google.dagger:hilt-compiler:2.48'
    
    // Networking
    implementation 'com.squareup.retrofit2:retrofit:2.9.0'
    implementation 'com.squareup.retrofit2:converter-gson:2.9.0'
    implementation 'com.squareup.okhttp3:logging-interceptor:4.12.0'
    
    // Database
    implementation 'androidx.room:room-runtime:2.6.1'
    implementation 'androidx.room:room-ktx:2.6.1'
    kapt 'androidx.room:room-compiler:2.6.1'
    
    // Coroutines
    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3'
    
    // Image Loading
    implementation 'io.coil-kt:coil-compose:2.5.0'
    
    // Maps
    implementation 'com.google.android.gms:play-services-maps:18.2.0'
    implementation 'com.google.android.gms:play-services-location:21.0.1'
}
```

### **PERMISOS REQUERIDOS**
```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
```

---

## ğŸš€ **IMPLEMENTACIÃ“N PASO A PASO**

### **FASE 1: SETUP BÃSICO (2-3 horas)**
1. Crear proyecto Android con Kotlin
2. Configurar dependencias Gradle
3. Setup Hilt para DI
4. Configurar Navigation Component
5. Crear estructura de packages

### **FASE 2: MODELOS Y API (2-3 horas)**
1. Crear data classes para modelos
2. Implementar ColisPriveApiService
3. Configurar Retrofit
4. Crear AuthInterceptor
5. Implementar Repository pattern

### **FASE 3: UI BÃSICA (3-4 horas)**
1. Implementar LoginActivity
2. Crear DashboardFragment
3. Implementar TourneeListFragment
4. Crear navegaciÃ³n bÃ¡sica
5. Implementar ViewModels

### **FASE 4: FUNCIONALIDAD COMPLETA (4-5 horas)**
1. Implementar TourneeDetailFragment
2. Crear DeliveryDetailFragment
3. Implementar mapa de entregas
4. Agregar funcionalidad de cÃ¡mara
5. Implementar sincronizaciÃ³n

### **FASE 5: TESTING Y PULIDO (2-3 horas)**
1. Testing manual de flujos
2. Manejo de errores
3. OptimizaciÃ³n de UI
4. Testing con API real
5. PreparaciÃ³n para demo

---

## ğŸ§ª **TESTING STRATEGY**

### **TESTING MANUAL**
- Login con credenciales reales
- NavegaciÃ³n entre pantallas
- Funcionalidad offline/online
- Manejo de errores de red
- Performance en diferentes dispositivos

### **TESTING AUTOMATIZADO**
- Unit tests para ViewModels
- Integration tests para Repository
- UI tests para flujos crÃ­ticos
- API tests con mock data

---

## ğŸ“± **REQUISITOS DEL DISPOSITIVO**

### **VERSIÃ“N MÃNIMA**
- **Android:** API 24 (Android 7.0)
- **RAM:** 2GB mÃ­nimo, 4GB recomendado
- **Storage:** 100MB disponible
- **Screen:** 4.5" mÃ­nimo, 5" recomendado

### **FUNCIONALIDADES REQUERIDAS**
- **GPS:** Para ubicaciÃ³n de entregas
- **CÃ¡mara:** Para fotos de confirmaciÃ³n
- **Internet:** WiFi o datos mÃ³viles
- **Touch:** Pantalla tÃ¡ctil

---

## ğŸ”‘ **CREDENCIALES DE TESTING**

### **API ENDPOINTS**
- **Desarrollo:** `http://192.168.1.100:3000` (MacBook)
- **ProducciÃ³n:** `http://192.168.1.101:3000` (Pi 5 Master)

### **CREDENCIALES DE PRUEBA**
```
Usuario: test_driver
ContraseÃ±a: test123
```

---

## ğŸ“‹ **CHECKLIST DE IMPLEMENTACIÃ“N**

### **SETUP INICIAL**
- [ ] Proyecto Android creado
- [ ] Dependencias configuradas
- [ ] Hilt configurado
- [ ] Navigation configurado
- [ ] Estructura de packages creada

### **MODELOS Y API**
- [ ] Data classes implementadas
- [ ] Retrofit configurado
- [ ] API service implementado
- [ ] Repository pattern implementado
- [ ] Auth interceptor configurado

### **UI Y NAVEGACIÃ“N**
- [ ] Login implementado
- [ ] Dashboard implementado
- [ ] Lista de tours implementada
- [ ] Detalles de tour implementados
- [ ] Detalles de entrega implementados

### **FUNCIONALIDADES**
- [ ] AutenticaciÃ³n funcionando
- [ ] Lista de tours cargando
- [ ] Mapa de entregas funcionando
- [ ] CÃ¡mara para fotos implementada
- [ ] SincronizaciÃ³n offline/online

### **TESTING**
- [ ] Login con credenciales reales
- [ ] NavegaciÃ³n completa funcionando
- [ ] API calls funcionando
- [ ] Manejo de errores implementado
- [ ] Performance aceptable

---

## ğŸ¯ **OBJETIVOS DEL DEMO**

### **FUNCIONALIDADES CRÃTICAS**
1. **Login exitoso** con credenciales reales
2. **Carga de tournÃ©e** desde API
3. **VisualizaciÃ³n de entregas** en lista
4. **NavegaciÃ³n fluida** entre pantallas
5. **Funcionamiento estable** sin crashes

### **MÃ‰TRICAS DE Ã‰XITO**
- **Tiempo de carga:** <3 segundos para tournÃ©e
- **Stability:** 0 crashes durante demo
- **UX:** NavegaciÃ³n intuitiva
- **Performance:** 60fps en navegaciÃ³n
- **Funcionalidad:** 100% de features crÃ­ticas funcionando

---

## ğŸš¨ **PROBLEMAS COMUNES Y SOLUCIONES**

### **1. ERRORES DE RED**
- Implementar retry automÃ¡tico
- Mostrar mensajes de error claros
- Cache offline para datos crÃ­ticos

### **2. PROBLEMAS DE MEMORIA**
- Usar ViewBinding en lugar de findViewById
- Implementar paginaciÃ³n en listas largas
- Optimizar carga de imÃ¡genes

### **3. PROBLEMAS DE NAVEGACIÃ“N**
- Usar Navigation Component
- Implementar deep linking
- Manejar back stack correctamente

### **4. PROBLEMAS DE PERFORMANCE**
- Usar Coroutines para operaciones async
- Implementar lazy loading
- Optimizar queries de base de datos

---

## ğŸ“š **RECURSOS ADICIONALES**

### **DOCUMENTACIÃ“N OFICIAL**
- [Android Developers](https://developer.android.com/)
- [Jetpack Compose](https://developer.android.com/jetpack/compose)
- [Navigation Component](https://developer.android.com/guide/navigation)
- [Room Database](https://developer.android.com/training/data-storage/room)

### **TUTORIALES RECOMENDADOS**
- MVVM + Repository Pattern
- Jetpack Compose UI
- Hilt Dependency Injection
- Retrofit + Coroutines
- Room Database

---

## ğŸ‰ **RESULTADO FINAL ESPERADO**

Una app Android completamente funcional que:
- âœ… Se conecta a la API Rust del backend
- âœ… Maneja autenticaciÃ³n con Colis PrivÃ©
- âœ… Muestra tours y entregas del dÃ­a
- âœ… Permite confirmar entregas
- âœ… Funciona offline/online
- âœ… Tiene UI moderna y responsive
- âœ… EstÃ¡ lista para demo del martes

---

*Prompt creado: 18 de Agosto, 2025*  
*Estado: ğŸŸ¢ LISTO PARA IMPLEMENTACIÃ“N*  
*Tiempo estimado: 12-18 horas de desarrollo*
